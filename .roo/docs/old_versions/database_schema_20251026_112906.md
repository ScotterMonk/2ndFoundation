# Database Schema Overview

*Last updated: 2025-07-17 08:06:11*

## Tables

### view: active_users_with_types
**Columns:**
- `id`: integer NULL
- `username`: character varying(100) NULL
- `email`: character varying(255) NULL
- `name_first`: character varying(100) NULL
- `name_last`: character varying(100) NULL
- `credit_balance`: integer NULL
- `is_active`: boolean NULL
- `created_at`: timestamp with time zone NULL
- `user_type_code`: character varying(50) NULL
- `user_type_name`: character varying(255) NULL
- `can_resell`: boolean NULL

### api_keys
**Primary Key:** id
**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `key_name`: character varying(100) NOT NULL
- `api_key`: character varying(255) NOT NULL
- `api_secret`: character varying(255) NULL
- `permissions`: jsonb NOT NULL
- `rate_limit_per_hour`: integer NOT NULL
- `is_active`: boolean NOT NULL
- `last_used_at`: timestamp with time zone NULL
- `expires_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `created_by` -> `users.id`

### cast
**Primary Key:** id
**Columns:**
- `id`: serial4 PRIMARY KEY
- `name`: varchar NOT NULL
- `imdb_cast_id`: varchar
- `profile_path`: varchar
- `tmdb_id`: int4
- `gender`: int4
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

### content_reports

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `reported_by_users_id`: integer NULL
- `media_id`: integer NOT NULL
- `report_type`: character varying(30) NOT NULL
- `description`: text NOT NULL
- `status`: character varying(20) NOT NULL
- `admin_notes`: text NULL
- `resolved_by_users_id`: integer NULL
- `resolved_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `reported_by_users_id` -> `users.id`
- `media_id` -> `media.id`
- `resolved_by_users_id` -> `users.id`

### credit_packages

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `credit_amount`: integer NOT NULL
- `price_amount`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `bonus_credits`: integer NOT NULL
- `is_active`: boolean NOT NULL
- `sort_order`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### credit_transactions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `transaction_type`: character varying(20) NOT NULL
- `amount`: integer NOT NULL
- `balance_before`: integer NOT NULL
- `balance_after`: integer NOT NULL
- `description`: text NULL
- `reference_type`: character varying(50) NULL
- `reference_id`: integer NULL
- `payment_id`: integer NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `payment_id` -> `payments.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### directors

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `name`: varchar NULL
- `description`: text NULL
- `profile_path`: varchar NULL
- `tmdb_id`: int4 NULL
- `imdb_id`: varchar NULL
- `gender`: int4 NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

### episodes

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NOT NULL
- `episode_number`: integer NULL
- `name`: character varying(255) NULL
- `overview`: text NULL
- `season_number`: integer NULL
- `still_path`: character varying(255) NULL
- `air_date`: timestamp with time zone NULL
- `vote_average`: real NULL
- `vote_count`: integer NULL
- `rating`: character varying(255) NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### events

**Primary Key:** id

**Columns:**
- `id`: bigint NOT NULL
- `events_type_id`: integer NOT NULL
- `users_id`: integer NULL
- `session_id`: character varying(255) NULL
- `ip_address`: inet NULL
- `users_agent`: text NULL
- `event_data`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `events_type_id` -> `events_types.id`
- `users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### events_types

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `is_tracked`: boolean NOT NULL
- `retention_days`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### files

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NULL
- `episode_id`: integer NULL
- `path`: character varying(500) NOT NULL
- `file_size`: bigint NULL
- `label`: character varying(255) NULL
- `original_filename`: character varying(500) NULL
- `content_type`: character varying(255) NULL
- `external_id`: character varying(255) NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `episode_id` -> `episodes.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### genres

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `tmdb_id`: integer NULL
- `name`: character varying(255) NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### invitations

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `inviter_users_id`: integer NOT NULL
- `invited_email`: character varying(255) NOT NULL
- `invitation_token`: character varying(255) NOT NULL
- `status`: character varying(20) NOT NULL
- `expires_at`: timestamp with time zone NOT NULL
- `accepted_users_id`: integer NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `inviter_users_id` -> `users.id`
- `accepted_users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### languages

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(10) NOT NULL
- `name`: character varying(50) NOT NULL
- `native_name`: character varying(50) NULL
- `is_active`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### media

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: int4
- `media_type_id`: int4
- `title`: varchar
- `title_alternate`: varchar
- `title_for_sorting`: varchar
- `description`: text
- `imdb_id`: varchar
- `imdb_rating`: numeric
- `tmdb_id`: int4
- `tmdb_rating`: numeric
- `tmdb_media_type`: varchar
- `tvdb_id`: int4
- `tvdb_rating`: numeric
- `other_id`: int4
- `other_rating`: numeric
- `user_score`: numeric
- `director_id`: int4
- `resolution`: varchar
- `filename_original`: varchar
- `filename_stored`: varchar
- `file_path`: varchar
- `file_size_bytes`: int8
- `mime_type`: varchar
- `file_hash`: varchar
- `thumbnail_path`: varchar
- `preview_path`: varchar
- `metadata`: jsonb
- `tags`: varchar
- `is_public`: bool
- `is_featured`: bool
- `is_processed`: bool
- `processing_status`: varchar
- `download_count`: int4
- `view_count`: int4
- `like_count`: int4
- `credit_cost`: int4
- `expires_at`: timestamptz
- `added_date`: timestamptz
- `backdrop_path`: varchar
- `content_id`: int4
- `content_type`: varchar
- `last_episode_air_date`: timestamptz
- `name`: varchar
- `original_language`: varchar
- `original_name`: varchar
- `overview`: text
- `release_date`: timestamptz
- `runtime`: int4
- `status`: varchar
- `still_path`: varchar
- `tagline`: varchar
- `total_episodes`: int4
- `total_seasons`: int4
- `trailer_id`: varchar
- `vote_average`: float4
- `vote_count`: int4
- `trailer_url`: varchar
- `video_trailer_file_id`: int4
- `genre`: varchar
- `adult`: bool
- `min_age`: int4
- `created_at`: timestamptz
- `updated_at`: timestamptz
- `created_by`: int4
- `updated_by`: int4

**Foreign Keys:**
- `users_id` -> `users.id`
- `media_type_id` -> `media_types.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
- `video_trailer_file_id` -> `files.id`
- `director_id` -> `directors.id`

### media_cast

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: int4 NOT NULL
- `cast_id`: int4 NOT NULL
- `created_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `cast_id` -> `cast.id`

### media_categories

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `parent_id`: integer NULL
- `name`: character varying(100) NOT NULL
- `slug`: character varying(100) NOT NULL
- `description`: text NULL
- `is_active`: boolean NOT NULL
- `sort_order`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `parent_id` -> `media_categories.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### media_categories_assignments

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NOT NULL
- `category_id`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `category_id` -> `media_categories.id`
- `created_by` -> `users.id`

### media_genres

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NOT NULL
- `genre_id`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `genre_id` -> `genres.id`
- `created_by` -> `users.id`

### media_quality_levels

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NOT NULL
- `quality_name`: character varying(20) NOT NULL
- `file_path`: character varying(1000) NOT NULL
- `file_size_bytes`: bigint NOT NULL
- `bitrate_kbps`: integer NULL
- `resolution_width`: integer NULL
- `resolution_height`: integer NULL
- `codec`: character varying(50) NULL
- `is_default`: boolean NOT NULL
- `processing_status`: character varying(20) NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `media_id` -> `media.id`

### media_subtitles

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `media_id`: integer NOT NULL
- `language_id`: integer NOT NULL
- `file_path`: character varying(1000) NOT NULL
- `file_size_bytes`: integer NULL
- `mime_type`: character varying(100) NULL
- `is_default`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `language_id` -> `languages.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### media_types

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `allowed_extensions`: ARRAY NULL
- `max_file_size_mb`: integer NULL
- `requires_processing`: boolean NOT NULL
- `credit_cost`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### notifications

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `notification_type`: character varying(50) NOT NULL
- `title`: character varying(255) NOT NULL
- `message`: text NOT NULL
- `action_url`: character varying(500) NULL
- `is_read`: boolean NOT NULL
- `is_sent`: boolean NOT NULL
- `priority`: character varying(10) NOT NULL
- `expires_at`: timestamp with time zone NULL
- `metadata`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `created_by` -> `users.id`

### payment_methods

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `is_active`: boolean NOT NULL
- `configuration`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### payments

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `payment_method_id`: integer NOT NULL
- `credit_package_id`: integer NULL
- `subscription_id`: integer NULL
- `payment_status`: character varying(20) NOT NULL
- `amount`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `credits_purchased`: integer NULL
- `external_transaction_id`: character varying(255) NULL
- `gateway_response`: jsonb NOT NULL
- `processed_at`: timestamp with time zone NULL
- `failed_reason`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `payment_method_id` -> `payment_methods.id`
- `credit_package_id` -> `credit_packages.id`
- `subscription_id` -> `subscriptions.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### playlists

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `name`: character varying(255) NOT NULL
- `description`: text NULL
- `is_public`: boolean NOT NULL
- `thumbnail_url`: character varying(1000) NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### playlists_media_items

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `playlist_id`: integer NOT NULL
- `media_id`: integer NOT NULL
- `sort_order`: integer NOT NULL
- `added_at`: timestamp with time zone NULL
- `added_by`: integer NULL

**Foreign Keys:**
- `playlist_id` -> `playlists.id`
- `media_id` -> `media.id`
- `added_by` -> `users.id`

### referral_codes

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `referrer_users_id`: integer NOT NULL
- `referred_users_id`: integer NULL
- `usage_limit`: integer NOT NULL
- `current_uses`: integer NOT NULL
- `reward_type`: character varying(20) NULL
- `reward_value`: integer NULL
- `expires_at`: timestamp with time zone NULL
- `is_active`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `referrer_users_id` -> `users.id`
- `referred_users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### resellers_assets

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `reseller_id`: integer NOT NULL
- `asset_type`: character varying(20) NOT NULL
- `asset_name`: character varying(255) NOT NULL
- `file_path`: character varying(500) NOT NULL
- `file_size_bytes`: integer NULL
- `mime_type`: character varying(100) NULL
- `is_active`: boolean NOT NULL
- `sort_order`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `reseller_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### resellers_commissions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `reseller_users_id`: integer NOT NULL
- `customer_users_id`: integer NOT NULL
- `transaction_type`: character varying(50) NOT NULL
- `reference_id`: integer NULL
- `commission_rate`: numeric(5,4) NOT NULL
- `base_amount`: numeric(15,2) NOT NULL
- `commission_amount`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `status`: character varying(20) NOT NULL
- `notes`: text NULL
- `approved_at`: timestamp with time zone NULL
- `paid_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `reseller_users_id` -> `users.id`
- `customer_users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### resellers_details

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `users_counter`: integer NOT NULL
- `users_max`: integer NOT NULL
- `business_name`: character varying(255) NULL
- `tax_id`: character varying(50) NULL
- `website_url`: character varying(500) NULL
- `commission_rate`: numeric(5,4) NOT NULL
- `min_payout_amount`: numeric(15,2) NOT NULL
- `payout_method`: character varying(50) NULL
- `payout_details`: jsonb NOT NULL
- `total_referrals`: integer NOT NULL
- `total_earnings`: numeric(15,2) NOT NULL
- `pending_earnings`: numeric(15,2) NOT NULL
- `paid_earnings`: numeric(15,2) NOT NULL
- `is_approved`: boolean NOT NULL
- `approval_date`: timestamp with time zone NULL
- `notes`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### resellers_settings

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `reseller_id`: integer NOT NULL
- `setting_key`: character varying(100) NOT NULL
- `setting_value`: text NULL
- `setting_type`: character varying(20) NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `reseller_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### subscriptions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `subscriptions_plan_id`: integer NOT NULL
- `start_date`: timestamp with time zone NOT NULL
- `end_date`: timestamp with time zone NOT NULL
- `status`: character varying(20) NOT NULL
- `auto_renew`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `subscriptions_plan_id` -> `subscriptions_plans.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### subscriptions_history

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `subscription_id`: integer NOT NULL
- `users_id`: integer NOT NULL
- `subscriptions_plan_id`: integer NOT NULL
- `action_type`: character varying(20) NOT NULL
- `old_status`: character varying(20) NULL
- `new_status`: character varying(20) NULL
- `old_end_date`: timestamp with time zone NULL
- `new_end_date`: timestamp with time zone NULL
- `reason`: text NULL
- `created_at`: timestamp with time zone NULL
- `created_by`: integer NULL

**Foreign Keys:**
- `subscription_id` -> `subscriptions.id`
- `users_id` -> `users.id`
- `subscriptions_plan_id` -> `subscriptions_plans.id`
- `created_by` -> `users.id`

### subscriptions_plans

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `price`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `duration_days`: integer NOT NULL
- `max_storage_mb`: integer NULL
- `max_uploads`: integer NULL
- `features`: jsonb NOT NULL
- `is_active`: boolean NOT NULL
- `sort_order`: integer NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### support_tickets

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `assigned_to_users_id`: integer NULL
- `subject`: character varying(255) NOT NULL
- `description`: text NULL
- `status`: character varying(20) NOT NULL
- `priority`: character varying(10) NOT NULL
- `category`: character varying(50) NULL
- `last_activity_at`: timestamp with time zone NULL
- `closed_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `assigned_to_users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### system_settings

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `setting_key`: character varying(100) NOT NULL
- `setting_value`: text NULL
- `setting_type`: character varying(20) NOT NULL
- `description`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

### tickets_messages

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `ticket_id`: integer NOT NULL
- `users_id`: integer NOT NULL
- `message`: text NOT NULL
- `is_internal`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `ticket_id` -> `support_tickets.id`
- `users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### transactions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `sender_users_id`: integer NULL
- `receiver_users_id`: integer NULL
- `transactions_type_id`: integer NOT NULL
- `amount`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `payment_method_id`: integer NULL
- `status`: character varying(20) NOT NULL
- `external_transaction_id`: character varying(255) NULL
- `notes`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `sender_users_id` -> `users.id`
- `receiver_users_id` -> `users.id`
- `transactions_type_id` -> `transactions_types.id`
- `payment_method_id` -> `payment_methods.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### transactions_types

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `name`: character varying(100) NOT NULL
- `description`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### tv_channels

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `name`: character varying(255) NOT NULL
- `channel_number`: integer NULL
- `logo_url`: character varying(500) NULL
- `stream_url`: character varying(1000) NOT NULL
- `description`: text NULL
- `category_id`: integer NULL
- `is_active`: boolean NOT NULL
- `geo_restriction`: jsonb NOT NULL
- `requires_subscriptions_plan_id`: integer NULL
- `credit_cost`: integer NOT NULL
- `metadata`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `category_id` -> `media_categories.id`
- `requires_subscriptions_plan_id` -> `subscriptions_plans.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### user_media_affinity

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `user_id`: integer NOT NULL
- `genre_id`: integer NOT NULL
- `affinity_score`: double precision NOT NULL
- `updated_at`: timestamp without time zone NOT NULL

**Foreign Keys:**
- `user_id` -> `users.id`
- `genre_id` -> `genres.id`

### users

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_type_id`: integer NOT NULL
- `parent_id`: integer NULL
- `referred_by_users_id`: integer NULL
- `payee_id`: integer NULL
- `username`: character varying(100) NOT NULL
- `email`: character varying(255) NOT NULL
- `pw_hashed`: character varying(255) NOT NULL
- `name_first`: character varying(100) NULL
- `name_last`: character varying(100) NULL
- `name_display`: character varying(150) NULL
- `phone`: character varying(20) NULL
- `address_1`: character varying(255) NULL
- `address_2`: character varying(255) NULL
- `city`: character varying(100) NULL
- `state`: character varying(100) NULL
- `postal_zip`: character varying(20) NULL
- `country`: character varying(100) NULL
- `about_users`: text NULL
- `avatar_url`: character varying(500) NULL
- `rating_limit`: character varying(10) NULL
- `credit_balance`: integer NOT NULL
- `total_storage_used_mb`: integer NOT NULL
- `is_active`: boolean NOT NULL
- `is_verified`: boolean NOT NULL
- `is_verified_email`: boolean NOT NULL
- `is_verified_phone`: boolean NOT NULL
- `preferences`: jsonb NOT NULL
- `new_episode_notification`: boolean NOT NULL
- `notification_settings`: jsonb NOT NULL
- `timezone`: character varying(50) NULL
- `language_preference`: character varying(10) NULL
- `last_login_at`: timestamp with time zone NULL
- `failed_login_attempts`: integer NOT NULL
- `is_locked_out`: boolean NOT NULL
- `lockout_until`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL
- `password_reset_token`: character varying(255) NULL
- `password_reset_expiration`: timestamp with time zone NULL

**Foreign Keys:**
- `users_type_id` -> `users_types.id`
- `parent_id` -> `users.id`
- `referred_by_users_id` -> `users.id`
- `payee_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### users_actions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `action_type`: character varying(50) NOT NULL
- `target_type`: character varying(50) NULL
- `target_id`: integer NULL
- `action_data`: jsonb NOT NULL
- `ip_address`: inet NULL
- `users_agent`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL
- `action_category`: character varying(50) NOT NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### users_devices

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `device_fingerprint`: character varying(255) NOT NULL
- `device_name`: character varying(255) NULL
- `device_type`: character varying(50) NULL
- `browser_info`: jsonb NOT NULL
- `is_trusted`: boolean NOT NULL
- `last_used_at`: timestamp with time zone NULL
- `ip_address`: inet NULL
- `location_info`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`

### users_favorites

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `media_id`: integer NOT NULL
- `favorite_type`: character varying(20) NOT NULL
- `notes`: text NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `media_id` -> `media.id`

### users_media_affinity

**Primary Key:** id

**Columns:**
- `id`: bigint NOT NULL
- `users_id`: integer NOT NULL
- `media_id`: integer NOT NULL
- `affinity_score`: real NOT NULL
- `affinity_type`: character varying(50) NOT NULL
- `explanation`: text NULL
- `last_calculated_at`: timestamp with time zone NULL
- `metadata`: jsonb NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `media_id` -> `media.id`

### users_media_history

**Primary Key:** id

**Columns:**
- `id`: bigint NOT NULL
- `users_id`: integer NOT NULL
- `media_id`: integer NOT NULL
- `action_type`: character varying(20) NOT NULL
- `playback_position_seconds`: integer NOT NULL
- `completion_percentage`: integer NOT NULL
- `credits_spent`: integer NOT NULL
- `quality_level`: character varying(20) NULL
- `device_type`: character varying(50) NULL
- `ip_address`: inet NULL
- `device_info`: jsonb NOT NULL
- `updated_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `media_id` -> `media.id`

### users_ratings

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `media_id`: integer NOT NULL
- `rating`: integer NOT NULL
- `review_text`: text NULL
- `is_public`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`
- `media_id` -> `media.id`

### users_referral_earnings

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `referrer_users_id`: integer NOT NULL
- `referred_users_id`: integer NOT NULL
- `referral_code_id`: integer NULL
- `earning_type`: character varying(30) NOT NULL
- `amount`: numeric(15,2) NOT NULL
- `currency`: character varying(3) NOT NULL
- `credits_awarded`: integer NOT NULL
- `reference_transaction_id`: integer NULL
- `status`: character varying(20) NOT NULL
- `paid_at`: timestamp with time zone NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `referrer_users_id` -> `users.id`
- `referred_users_id` -> `users.id`
- `referral_code_id` -> `referral_codes.id`

### users_sessions

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `users_id`: integer NOT NULL
- `session_token`: character varying(255) NOT NULL
- `device_info`: jsonb NOT NULL
- `ip_address`: inet NULL
- `is_active`: boolean NOT NULL
- `last_activity_at`: timestamp with time zone NULL
- `expires_at`: timestamp with time zone NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL

**Foreign Keys:**
- `users_id` -> `users.id`

### users_types

**Primary Key:** id

**Columns:**
- `id`: serial4 PRIMARY KEY
- `code`: character varying(50) NOT NULL
- `name`: character varying(255) NOT NULL
- `description`: text NULL
- `max_uploads`: integer NOT NULL
- `max_storage_mb`: integer NOT NULL
- `can_resell`: boolean NOT NULL
- `created_at`: timestamp with time zone NULL
- `updated_at`: timestamp with time zone NULL
- `created_by`: integer NULL
- `updated_by`: integer NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
