# Database Schema Overview

*Last updated (UTC): 2025-10-27 23:26:20*

> Generated by unified Schema Inspector. Source of Truth (SoT): Live PGDB.
> Regenerate with: python utils/schema_inspector.py generate-docs

## Tables

### api_keys

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `key_name`: VARCHAR(100) NOT NULL
- `api_key`: VARCHAR(255) NOT NULL
- `api_secret`: VARCHAR(255) NULL
- `permissions`: JSONB NOT NULL
- `rate_limit_per_hour`: INTEGER NOT NULL
- `is_active`: BOOLEAN NOT NULL
- `last_used_at`: TIMESTAMP NULL
- `expires_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `users_id` -> `users.id`

### content_reports

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `reported_by_users_id`: INTEGER NULL
- `media_id`: INTEGER NOT NULL
- `report_type`: VARCHAR(30) NOT NULL
- `description`: TEXT NOT NULL
- `status`: VARCHAR(20) NOT NULL
- `admin_notes`: TEXT NULL
- `resolved_by_users_id`: INTEGER NULL
- `resolved_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `reported_by_users_id` -> `users.id`
- `resolved_by_users_id` -> `users.id`

### credit_packages

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `credit_amount`: INTEGER NOT NULL
- `price_amount`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `bonus_credits`: INTEGER NOT NULL
- `is_active`: BOOLEAN NOT NULL
- `sort_order`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### credit_transactions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `transaction_type`: VARCHAR(20) NOT NULL
- `amount`: INTEGER NOT NULL
- `balance_before`: INTEGER NOT NULL
- `balance_after`: INTEGER NOT NULL
- `description`: TEXT NULL
- `reference_type`: VARCHAR(50) NULL
- `reference_id`: INTEGER NULL
- `payment_id`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `payment_id` -> `payments.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### directors

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR NULL
- `description`: TEXT NULL
- `profile_path`: VARCHAR NULL
- `tmdb_id`: INTEGER NULL
- `imdb_id`: VARCHAR NULL
- `gender`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

### episodes

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `episode_number`: INTEGER NULL
- `name`: VARCHAR(255) NULL
- `overview`: TEXT NULL
- `season_number`: INTEGER NULL
- `still_path`: VARCHAR(255) NULL
- `air_date`: TIMESTAMP NULL
- `vote_average`: REAL NULL
- `vote_count`: INTEGER NULL
- `user_score`: VARCHAR(255) NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `media_id` -> `media.id`
- `updated_by` -> `users.id`

### events

**Primary Key:** id

**Columns:**
- `id`: BIGINT NOT NULL
- `events_type_id`: INTEGER NOT NULL
- `users_id`: INTEGER NULL
- `session_id`: VARCHAR(255) NULL
- `ip_address`: INET NULL
- `users_agent`: TEXT NULL
- `event_data`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `events_type_id` -> `events_types.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### events_types

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `name`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `is_tracked`: BOOLEAN NOT NULL
- `retention_days`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### files

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NULL
- `episode_id`: INTEGER NULL
- `path`: VARCHAR(500) NOT NULL
- `file_size`: BIGINT NULL
- `label`: VARCHAR(255) NULL
- `original_filename`: VARCHAR(500) NULL
- `content_type`: VARCHAR(255) NULL
- `external_id`: VARCHAR(255) NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `episode_id` -> `episodes.id`
- `media_id` -> `media.id`
- `updated_by` -> `users.id`

### genres

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR(255) NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### invitations

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `inviter_users_id`: INTEGER NOT NULL
- `invited_email`: VARCHAR(255) NOT NULL
- `invitation_token`: VARCHAR(255) NOT NULL
- `status`: VARCHAR(20) NOT NULL
- `expires_at`: TIMESTAMP NOT NULL
- `accepted_users_id`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `accepted_users_id` -> `users.id`
- `created_by` -> `users.id`
- `inviter_users_id` -> `users.id`
- `updated_by` -> `users.id`

### languages

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(10) NOT NULL
- `name`: VARCHAR(50) NOT NULL
- `native_name`: VARCHAR(50) NULL
- `is_active`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### media

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `media_type_id`: INTEGER NOT NULL
- `title`: VARCHAR NOT NULL
- `description`: TEXT NULL
- `imdb_id`: VARCHAR NULL
- `imdb_rating`: NUMERIC NULL
- `tmdb_id`: INTEGER NULL
- `tmdb_rating`: NUMERIC NULL
- `tmdb_media_type`: VARCHAR NULL
- `tvdb_id`: INTEGER NULL
- `tvdb_rating`: NUMERIC NULL
- `other_id`: INTEGER NULL
- `other_rating`: NUMERIC NULL
- `user_score`: NUMERIC NULL
- `resolution`: VARCHAR NULL
- `filename_original`: VARCHAR NOT NULL
- `filename_stored`: VARCHAR NOT NULL
- `file_path`: VARCHAR NOT NULL
- `file_size_bytes`: BIGINT NOT NULL
- `mime_type`: VARCHAR NOT NULL
- `file_hash`: VARCHAR NULL
- `thumbnail_path`: VARCHAR NULL
- `preview_path`: VARCHAR NULL
- `metadata_`: JSONB NOT NULL
- `tags`: VARCHAR NULL
- `is_public`: BOOLEAN NOT NULL
- `is_featured`: BOOLEAN NOT NULL
- `is_processed`: BOOLEAN NOT NULL
- `processing_status`: VARCHAR NOT NULL
- `download_count`: INTEGER NOT NULL
- `view_count`: INTEGER NOT NULL
- `like_count`: INTEGER NOT NULL
- `credit_cost`: INTEGER NOT NULL
- `expires_at`: TIMESTAMP NULL
- `added_date`: TIMESTAMP NULL
- `backdrop_path`: VARCHAR NULL
- `content_id`: INTEGER NULL
- `content_type`: VARCHAR NULL
- `last_episode_air_date`: TIMESTAMP NULL
- `name`: VARCHAR NULL
- `original_language`: VARCHAR NULL
- `original_name`: VARCHAR NULL
- `overview`: TEXT NULL
- `release_date`: TIMESTAMP NULL
- `runtime`: INTEGER NULL
- `status`: VARCHAR NULL
- `still_path`: VARCHAR NULL
- `tagline`: VARCHAR NULL
- `total_episodes`: INTEGER NULL
- `total_seasons`: INTEGER NULL
- `trailer_id`: VARCHAR NULL
- `vote_average`: REAL NULL
- `vote_count`: INTEGER NULL
- `trailer_url`: VARCHAR NULL
- `video_trailer_file_id`: INTEGER NULL
- `genre`: VARCHAR NULL
- `adult`: BOOLEAN NOT NULL
- `min_age`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `title_alternate`: VARCHAR NULL
- `title_for_sorting`: VARCHAR NULL

**Foreign Keys:**
- `video_trailer_file_id` -> `files.id`
- `created_by` -> `users.id`
- `media_type_id` -> `media_types.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### media_backup

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `media_type_id`: INTEGER NOT NULL
- `title`: VARCHAR(255) NOT NULL
- `description`: TEXT NULL
- `filename_original`: VARCHAR(500) NOT NULL
- `filename_stored`: VARCHAR(500) NOT NULL
- `file_path`: VARCHAR(1000) NOT NULL
- `file_size_bytes`: BIGINT NOT NULL
- `mime_type`: VARCHAR(100) NOT NULL
- `file_hash`: VARCHAR(255) NULL
- `thumbnail_path`: VARCHAR(1000) NULL
- `preview_path`: VARCHAR(1000) NULL
- `_metadata`: JSONB NOT NULL
- `tags`: ARRAY NULL
- `is_public`: BOOLEAN NOT NULL
- `is_featured`: BOOLEAN NOT NULL
- `is_processed`: BOOLEAN NOT NULL
- `processing_status`: VARCHAR(20) NOT NULL
- `download_count`: INTEGER NOT NULL
- `view_count`: INTEGER NOT NULL
- `like_count`: INTEGER NOT NULL
- `credit_cost`: INTEGER NOT NULL
- `expires_at`: TIMESTAMP NULL
- `added_date`: TIMESTAMP NULL
- `backdrop_path`: VARCHAR(255) NULL
- `content_id`: INTEGER NULL
- `content_type`: VARCHAR(255) NULL
- `last_episode_air_date`: TIMESTAMP NULL
- `name`: VARCHAR(255) NULL
- `original_language`: VARCHAR(255) NULL
- `original_name`: VARCHAR(255) NULL
- `overview`: TEXT NULL
- `release_date`: TIMESTAMP NULL
- `runtime`: INTEGER NULL
- `status`: VARCHAR(255) NULL
- `still_path`: VARCHAR(255) NULL
- `tagline`: VARCHAR(255) NULL
- `tmdb_id`: INTEGER NULL
- `total_episodes`: INTEGER NULL
- `total_seasons`: INTEGER NULL
- `trailer_id`: VARCHAR(255) NULL
- `vote_average`: REAL NULL
- `vote_count`: INTEGER NULL
- `trailer_url`: VARCHAR(255) NULL
- `tmdb_media_type`: VARCHAR(255) NULL
- `video_trailer_file_id`: INTEGER NULL
- `imdb_id`: VARCHAR(255) NULL
- `genre`: VARCHAR(255) NULL
- `adult`: BOOLEAN NOT NULL
- `min_age`: INTEGER NOT NULL
- `user_score`: VARCHAR(255) NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `tvdb_id`: INTEGER NULL
- `tmdb_rating`: NUMERIC NULL
- `imdb_rating`: NUMERIC NULL

### media_categories

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `parent_id`: INTEGER NULL
- `name`: VARCHAR(100) NOT NULL
- `slug`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `is_active`: BOOLEAN NOT NULL
- `sort_order`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `parent_id` -> `media_categories.id`
- `updated_by` -> `users.id`

### media_categories_assignments

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `category_id`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL

**Foreign Keys:**
- `category_id` -> `media_categories.id`
- `created_by` -> `users.id`
- `media_id` -> `media.id`

### media_directors

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NULL
- `director_id`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `director_id` -> `directors.id`
- `media_id` -> `media.id`
- `updated_by` -> `users.id`

### media_genres

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `genre_id`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `genre_id` -> `genres.id`
- `media_id` -> `media.id`

### media_ignore

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `imdb_id`: VARCHAR NULL
- `media_id`: INTEGER NULL
- `other_id`: VARCHAR NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

### media_performers

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `performer_id`: INTEGER NOT NULL
- `character_name`: VARCHAR NULL
- `gender`: INTEGER NULL
- `created_at`: TIMESTAMP NOT NULL
- `updated_at`: TIMESTAMP NOT NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `media_id` -> `media.id`

### media_quality_levels

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `quality_name`: VARCHAR(20) NOT NULL
- `file_path`: VARCHAR(1000) NOT NULL
- `file_size_bytes`: BIGINT NOT NULL
- `bitrate_kbps`: INTEGER NULL
- `resolution_width`: INTEGER NULL
- `resolution_height`: INTEGER NULL
- `codec`: VARCHAR(50) NULL
- `is_default`: BOOLEAN NOT NULL
- `processing_status`: VARCHAR(20) NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`

### media_subtitles

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `language_id`: INTEGER NOT NULL
- `file_path`: VARCHAR(1000) NOT NULL
- `file_size_bytes`: INTEGER NULL
- `mime_type`: VARCHAR(100) NULL
- `is_default`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `language_id` -> `languages.id`
- `media_id` -> `media.id`
- `updated_by` -> `users.id`

### media_types

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `name`: VARCHAR(50) NOT NULL
- `description`: TEXT NULL
- `allowed_extensions`: ARRAY NULL
- `max_file_size_mb`: INTEGER NULL
- `requires_processing`: BOOLEAN NOT NULL
- `credit_cost`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `codes_imdb`: VARCHAR NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### notifications

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `notification_type`: VARCHAR(50) NOT NULL
- `title`: VARCHAR(255) NOT NULL
- `message`: TEXT NOT NULL
- `action_url`: VARCHAR(500) NULL
- `is_read`: BOOLEAN NOT NULL
- `is_sent`: BOOLEAN NOT NULL
- `priority`: VARCHAR(10) NOT NULL
- `expires_at`: TIMESTAMP NULL
- `_metadata`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `users_id` -> `users.id`

### payment_methods

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `name`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `is_active`: BOOLEAN NOT NULL
- `configuration`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### payments

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `payment_method_id`: INTEGER NOT NULL
- `credit_package_id`: INTEGER NULL
- `subscription_id`: INTEGER NULL
- `payment_status`: VARCHAR(20) NOT NULL
- `amount`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `credits_purchased`: INTEGER NULL
- `external_transaction_id`: VARCHAR(255) NULL
- `gateway_response`: JSONB NOT NULL
- `processed_at`: TIMESTAMP NULL
- `failed_reason`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `credit_package_id` -> `credit_packages.id`
- `payment_method_id` -> `payment_methods.id`
- `subscription_id` -> `subscriptions.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### performers

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR NULL
- `imdb_cast_id`: VARCHAR NULL
- `profile_path`: VARCHAR NULL
- `tmdb_id`: INTEGER NULL
- `gender`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

### playlists

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `name`: VARCHAR(255) NOT NULL
- `description`: TEXT NULL
- `is_public`: BOOLEAN NOT NULL
- `thumbnail_url`: VARCHAR(1000) NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### playlists_media_items

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `playlist_id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `sort_order`: INTEGER NOT NULL
- `added_at`: TIMESTAMP NULL
- `added_by`: INTEGER NULL

**Foreign Keys:**
- `added_by` -> `users.id`
- `media_id` -> `media.id`
- `playlist_id` -> `playlists.id`

### referral_codes

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `referrer_users_id`: INTEGER NOT NULL
- `referred_users_id`: INTEGER NULL
- `usage_limit`: INTEGER NOT NULL
- `current_uses`: INTEGER NOT NULL
- `reward_type`: VARCHAR(20) NULL
- `reward_value`: INTEGER NULL
- `expires_at`: TIMESTAMP NULL
- `is_active`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `referred_users_id` -> `users.id`
- `referrer_users_id` -> `users.id`
- `updated_by` -> `users.id`

### resellers_assets

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `reseller_id`: INTEGER NOT NULL
- `asset_type`: VARCHAR(20) NOT NULL
- `asset_name`: VARCHAR(255) NOT NULL
- `file_path`: VARCHAR(500) NOT NULL
- `file_size_bytes`: INTEGER NULL
- `mime_type`: VARCHAR(100) NULL
- `is_active`: BOOLEAN NOT NULL
- `sort_order`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `reseller_id` -> `users.id`
- `updated_by` -> `users.id`

### resellers_commissions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `reseller_users_id`: INTEGER NOT NULL
- `customer_users_id`: INTEGER NOT NULL
- `transaction_type`: VARCHAR(50) NOT NULL
- `reference_id`: INTEGER NULL
- `commission_rate`: NUMERIC(5, 4) NOT NULL
- `base_amount`: NUMERIC(15, 2) NOT NULL
- `commission_amount`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `status`: VARCHAR(20) NOT NULL
- `notes`: TEXT NULL
- `approved_at`: TIMESTAMP NULL
- `paid_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `customer_users_id` -> `users.id`
- `reseller_users_id` -> `users.id`
- `updated_by` -> `users.id`

### resellers_details

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `users_counter`: INTEGER NOT NULL
- `users_max`: INTEGER NOT NULL
- `business_name`: VARCHAR(255) NULL
- `tax_id`: VARCHAR(50) NULL
- `website_url`: VARCHAR(500) NULL
- `commission_rate`: NUMERIC(5, 4) NOT NULL
- `min_payout_amount`: NUMERIC(15, 2) NOT NULL
- `payout_method`: VARCHAR(50) NULL
- `payout_details`: JSONB NOT NULL
- `total_referrals`: INTEGER NOT NULL
- `total_earnings`: NUMERIC(15, 2) NOT NULL
- `pending_earnings`: NUMERIC(15, 2) NOT NULL
- `paid_earnings`: NUMERIC(15, 2) NOT NULL
- `is_approved`: BOOLEAN NOT NULL
- `approval_date`: TIMESTAMP NULL
- `notes`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### resellers_settings

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `reseller_id`: INTEGER NOT NULL
- `setting_key`: VARCHAR(100) NOT NULL
- `setting_value`: TEXT NULL
- `setting_type`: VARCHAR(20) NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `reseller_id` -> `users.id`
- `updated_by` -> `users.id`

### subscriptions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `subscriptions_plan_id`: INTEGER NOT NULL
- `start_date`: TIMESTAMP NOT NULL
- `end_date`: TIMESTAMP NOT NULL
- `status`: VARCHAR(20) NOT NULL
- `auto_renew`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `subscriptions_plan_id` -> `subscriptions_plans.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### subscriptions_history

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `subscription_id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `subscriptions_plan_id`: INTEGER NOT NULL
- `action_type`: VARCHAR(20) NOT NULL
- `old_status`: VARCHAR(20) NULL
- `new_status`: VARCHAR(20) NULL
- `old_end_date`: TIMESTAMP NULL
- `new_end_date`: TIMESTAMP NULL
- `reason`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `subscription_id` -> `subscriptions.id`
- `subscriptions_plan_id` -> `subscriptions_plans.id`
- `users_id` -> `users.id`

### subscriptions_plans

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `price`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `duration_days`: INTEGER NOT NULL
- `max_storage_mb`: INTEGER NULL
- `max_uploads`: INTEGER NULL
- `features`: JSONB NOT NULL
- `is_active`: BOOLEAN NOT NULL
- `sort_order`: INTEGER NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### support_tickets

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `assigned_to_users_id`: INTEGER NULL
- `subject`: VARCHAR(255) NOT NULL
- `description`: TEXT NULL
- `status`: VARCHAR(20) NOT NULL
- `priority`: VARCHAR(10) NOT NULL
- `category`: VARCHAR(50) NULL
- `last_activity_at`: TIMESTAMP NULL
- `closed_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `assigned_to_users_id` -> `users.id`
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### system_settings

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `setting_key`: VARCHAR(100) NOT NULL
- `setting_value`: TEXT NULL
- `setting_type`: VARCHAR(20) NOT NULL
- `description`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

### tickets_messages

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `ticket_id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `message`: TEXT NOT NULL
- `is_internal`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `ticket_id` -> `support_tickets.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### transactions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `sender_users_id`: INTEGER NULL
- `receiver_users_id`: INTEGER NULL
- `transactions_type_id`: INTEGER NOT NULL
- `amount`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `payment_method_id`: INTEGER NULL
- `status`: VARCHAR(20) NOT NULL
- `external_transaction_id`: VARCHAR(255) NULL
- `notes`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `payment_method_id` -> `payment_methods.id`
- `receiver_users_id` -> `users.id`
- `sender_users_id` -> `users.id`
- `transactions_type_id` -> `transactions_types.id`
- `updated_by` -> `users.id`

### transactions_types

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `name`: VARCHAR(100) NOT NULL
- `description`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`

### tv_channels

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `name`: VARCHAR(255) NOT NULL
- `channel_number`: INTEGER NULL
- `logo_url`: VARCHAR(500) NULL
- `stream_url`: VARCHAR(1000) NOT NULL
- `description`: TEXT NULL
- `category_id`: INTEGER NULL
- `is_active`: BOOLEAN NOT NULL
- `geo_restriction`: JSONB NOT NULL
- `requires_subscriptions_plan_id`: INTEGER NULL
- `credit_cost`: INTEGER NOT NULL
- `metadata_`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `imdb_rating`: NUMERIC(3, 1) NULL

**Foreign Keys:**
- `category_id` -> `media_categories.id`
- `created_by` -> `users.id`
- `requires_subscriptions_plan_id` -> `subscriptions_plans.id`
- `updated_by` -> `users.id`

### users

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_type_id`: INTEGER NOT NULL
- `parent_id`: INTEGER NULL
- `referred_by_users_id`: INTEGER NULL
- `payee_id`: INTEGER NULL
- `username`: VARCHAR(100) NOT NULL
- `email`: VARCHAR(255) NOT NULL
- `pw_hashed`: VARCHAR(255) NOT NULL
- `name_first`: VARCHAR(100) NULL
- `name_last`: VARCHAR(100) NULL
- `name_display`: VARCHAR(150) NULL
- `phone`: VARCHAR(20) NULL
- `address_1`: VARCHAR(255) NULL
- `address_2`: VARCHAR(255) NULL
- `city`: VARCHAR(100) NULL
- `state`: VARCHAR(100) NULL
- `postal_zip`: VARCHAR(20) NULL
- `country`: VARCHAR(100) NULL
- `about_users`: TEXT NULL
- `avatar_url`: VARCHAR(500) NULL
- `user_score_limit`: VARCHAR(10) NULL
- `credit_balance`: INTEGER NOT NULL
- `total_storage_used_mb`: INTEGER NOT NULL
- `is_active`: BOOLEAN NOT NULL
- `is_verified`: BOOLEAN NOT NULL
- `is_verified_email`: BOOLEAN NOT NULL
- `is_verified_phone`: BOOLEAN NOT NULL
- `preferences`: JSONB NOT NULL
- `new_episode_notification`: BOOLEAN NOT NULL
- `notification_settings`: JSONB NOT NULL
- `timezone`: VARCHAR(50) NULL
- `language_preference`: VARCHAR(10) NULL
- `last_login_at`: TIMESTAMP NULL
- `failed_login_attempts`: INTEGER NOT NULL
- `is_locked_out`: BOOLEAN NOT NULL
- `lockout_until`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `password_reset_token`: VARCHAR(255) NULL
- `password_reset_expiration`: TIMESTAMP NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `parent_id` -> `users.id`
- `payee_id` -> `users.id`
- `referred_by_users_id` -> `users.id`
- `updated_by` -> `users.id`
- `users_type_id` -> `users_types.id`

### users_actions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `action_type`: VARCHAR(50) NOT NULL
- `target_type`: VARCHAR(50) NULL
- `target_id`: INTEGER NULL
- `action_data`: JSONB NOT NULL
- `ip_address`: INET NULL
- `users_agent`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL
- `action_category`: VARCHAR(50) NOT NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
- `users_id` -> `users.id`

### users_devices

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `device_fingerprint`: VARCHAR(255) NOT NULL
- `device_name`: VARCHAR(255) NULL
- `device_type`: VARCHAR(50) NULL
- `browser_info`: JSONB NOT NULL
- `is_trusted`: BOOLEAN NOT NULL
- `last_used_at`: TIMESTAMP NULL
- `ip_address`: INET NULL
- `location_info`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `users_id` -> `users.id`

### users_faves_directors

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `user_id`: INTEGER NULL
- `director_id`: INTEGER NULL
- `weight`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `director_id` -> `directors.id`
- `user_id` -> `users.id`

### users_faves_genres

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `user_id`: INTEGER NOT NULL
- `genre_id`: INTEGER NOT NULL
- `weight`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `genre_id` -> `genres.id`
- `updated_by` -> `users.id`
- `user_id` -> `users.id`

### users_faves_performers

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `user_id`: INTEGER NULL
- `performer_id`: INTEGER NULL
- `weight`: INTEGER NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `performer_id` -> `performers.id`
- `updated_by` -> `users.id`
- `user_id` -> `users.id`

### users_favorites

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NULL
- `media_id`: INTEGER NULL
- `favorite_type`: VARCHAR(20) NULL
- `notes`: TEXT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `users_id` -> `users.id`

### users_media_affinity

**Primary Key:** id

**Columns:**
- `id`: BIGINT NOT NULL
- `users_id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `affinity_score`: REAL NOT NULL
- `affinity_type`: VARCHAR(50) NOT NULL
- `explanation`: TEXT NULL
- `last_calculated_at`: TIMESTAMP NULL
- `affinity_metadata_`: JSONB NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `users_id` -> `users.id`

### users_media_history

**Primary Key:** id

**Columns:**
- `id`: BIGINT NOT NULL
- `users_id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `action_type`: VARCHAR(20) NOT NULL
- `playback_position_seconds`: INTEGER NOT NULL
- `completion_percentage`: INTEGER NOT NULL
- `credits_spent`: INTEGER NOT NULL
- `quality_level`: VARCHAR(20) NULL
- `device_type`: VARCHAR(50) NULL
- `ip_address`: INET NULL
- `device_info`: JSONB NOT NULL
- `updated_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `users_id` -> `users.id`

### users_ratings

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `media_id`: INTEGER NOT NULL
- `user_score`: INTEGER NOT NULL
- `review_text`: TEXT NULL
- `is_public`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `media_id` -> `media.id`
- `users_id` -> `users.id`

### users_referral_earnings

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `referrer_users_id`: INTEGER NOT NULL
- `referred_users_id`: INTEGER NOT NULL
- `referral_code_id`: INTEGER NULL
- `earning_type`: VARCHAR(30) NOT NULL
- `amount`: NUMERIC(15, 2) NOT NULL
- `currency`: VARCHAR(3) NOT NULL
- `credits_awarded`: INTEGER NOT NULL
- `reference_transaction_id`: INTEGER NULL
- `status`: VARCHAR(20) NOT NULL
- `paid_at`: TIMESTAMP NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `referral_code_id` -> `referral_codes.id`
- `referred_users_id` -> `users.id`
- `referrer_users_id` -> `users.id`

### users_sessions

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `users_id`: INTEGER NOT NULL
- `session_token`: VARCHAR(255) NOT NULL
- `device_info`: JSONB NOT NULL
- `ip_address`: INET NULL
- `is_active`: BOOLEAN NOT NULL
- `last_activity_at`: TIMESTAMP NULL
- `expires_at`: TIMESTAMP NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL

**Foreign Keys:**
- `users_id` -> `users.id`

### users_types

**Primary Key:** id

**Columns:**
- `id`: INTEGER NOT NULL
- `code`: VARCHAR(50) NOT NULL
- `name`: VARCHAR(255) NOT NULL
- `description`: TEXT NULL
- `max_uploads`: INTEGER NOT NULL
- `max_storage_mb`: INTEGER NOT NULL
- `can_resell`: BOOLEAN NOT NULL
- `created_at`: TIMESTAMP NULL
- `updated_at`: TIMESTAMP NULL
- `created_by`: INTEGER NULL
- `updated_by`: INTEGER NULL

**Foreign Keys:**
- `created_by` -> `users.id`
- `updated_by` -> `users.id`
